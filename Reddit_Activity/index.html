<!DOCTYPE html>
<html ng-app="redditApp">
  <head>
    <meta charset="utf-8">
    <title>Reddit App</title>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.0-rc.2/angular.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.4.0/angular-messages.js"></script>
    <script type="text/javascript" src="index.js"></script>
    <link rel="stylesheet" href="app.css">
  </head>
  <body ng-controller="MyController">
    <div class="header">
      <p>Reddit</p>
      <p>Search for Post
        <input type="text" ng-model="searchable.name">
      </p>
      <div ng-click="showme=true">
        <input type="button" value="Add a Post">
      </div>
    </div>
    <div class="postForm" ng-show="showme">
      <form ng-submit="newPost()" novalidate>
        <p>Add a New Post</p>
        <input type="text" placeholder="Title" ng-model="title" ng-minlength="3" ng-maxlength="50" required>
        <input type="text" placeholder="Image" ng-model="image" required>
        <br>
        <textarea rows="5" cols="15" ng-model="description" ng-maxlength="255" required>Description</textarea>
        <br>
        <input type="text" placeholder="Author" ng-model="author" ng-maxlength="12" required>

        <div ng-messages="postForm.title.$error" ng-if="postForm.title.$touched">
          <p ng-message="minlength">Title is too short</p>
          <p ng-message="maxlength">Title is too long</p>
          <p ng-message="required">Title is required</p>
        </div>
        <div ng-messages="postForm.image.$error" ng-if="postForm.image.$touched">
          <p ng-message="required">Image is required</p>
        </div>
        <div ng-messages="postForm.description.$error" ng-if="postForm.description.$touched">
          <p ng-message="maxlength">Description is too long</p>
          <p ng-message="required">Description is required</p>
        </div>
        <div ng-messages="postForm.author.$error" ng-if="postForm.author.$touched">
          <p ng-message="maxlength">Author is too long</p>
          <p ng-message="required">Author is required</P>
        </div>
        <div ng-click="showme=false">
          <input type="submit" value="{{buttonText}}">
        </div>
      </form>
    </div>

    <div class="postLoop" ng-repeat="post in posts | filter:searchable.name">
      <img src="{{post.image}}" class="image"></img>
      <div class="content">
      <p class="postTitle">{{post.title | uppercase}}</p>
      <p class="likes" ng-click="plusOne(post)">upvote</p>
      <p class="dislikes" ng-click="minusOne(post)">downvote</p>
      <p>{{post.votes}}</p>
      <p class="author">{{post.author}}<i> says:</i></p>
      <p class="description">{{post.description}}</p>
      <p class="date">{{post.date | date:'medium'}}</p>
      <hr>
      </div>

      <div ng-click="showComments=true">
        <input type="button" value="Add a Comment">
      </div>


      <div class="showComments" ng-show="showComments">
        <form ng-submit="newComments(post)">
          <input type="text" placeholder="Comment" ng-model="$parent.usercomment" required>
          <input type="text" placeholder="Commentor" ng-model="$parent.commentor" required>
          <span ng-show="form.$error.required" >These Fields are Required, Brah!</span>
          <div ng-click="showComments=false">
            <input type="submit" value="{{commentText}}">
          </div>
        </form>
      </div>

      <div class="commentLoop" ng-show={{post.displayComments}} ng-repeat="comment in post.comments | filter:searchable.commentor">
        <p class="usercomment">{{comment.usercomment}}</p>
        <p class="commentor">{{comment.commentor}}</p>
    </div>
    <div>
    <input ng-click="toggleComments(post)" type="submit" value="{{commentButton}}">
    </div>
    </div>
  </body>
</html>
